Steps to set up Jenkins YAML for deploying on Docker Desktop starting
with the verbatim example at
https://www.jenkins.io/doc/book/installing/kubernetes/#install-jenkins-with-helm-v3

Copy the YAML from the GitHub raw user content entries under
https://www.jenkins.io/doc/book/installing/kubernetes/#install-jenkins-with-helm-v3
to
`jenkins-volume.yaml`
`jenkins-sa.yaml`
`jenkins-values.yaml`

Adapt `jenkins-volume-yaml` as follows to be compatible with Docker Desktop:

```
   persistentVolumeReclaimPolicy: Retain
   hostPath:
-    path: /data/jenkins-volume/
+    path: /mnt/data

 ---
 apiVersion: storage.k8s.io/v1
```

To prevent Helm installation errors, edit `jenkins-sa.yaml` as follows:
```
 metadata:
   name: jenkins
   namespace: jenkins
+  labels:
+    app.kubernetes.io/managed-by: Helm
+  annotations:
+    meta.helm.sh/release-name: jenkins
+    meta.helm.sh/release-namespace: jenkins
 ---
 apiVersion: rbac.authorization.k8s.io/v1
 kind: ClusterRole
```
That is probably necessary for any recent Helm and not specific to Docker
Destkop.


Apply edits as described in documentation to `jenkins-values.yaml` as follows:

```
  # -- k8s service type
- serviceType: ClusterIP
+ serviceType: NodePort
...
  # -- k8s node port. Only used if serviceType is NodePort
+ nodePort:
+ nodePort: 32000
...
  # -- Storage class for the PVC
- storageClass:
+ storageClass: jenkins-pv
...
  # -- Override the default service account
  # @default -- `serviceAccountAgent.name` if `agent.useDefaultServiceAccount` is `true`
  serviceAccount:
+   create: false
+   # Service account name is autogenerated by default
+   name: jenkins
+   annotations: {}
```

Further edits that *may* be necessary:
```
  # -- Controller ServiceAccount image pull secret
  imagePullSecretName:
- # -- Auto-mount ServiceAccount token
- automountServiceAccountToken: true
...
  # -- Agent ServiceAccount image pull secret
  imagePullSecretName:
- # -- Auto-mount ServiceAccount token
- automountServiceAccountToken: true
```

**Apply YAML**

```
kubectl create namespace jenkins
kubectl apply -f jenkins-volume.yaml
kubectl apply -f jenkins-sa.yaml
helm install jenkins -n jenkins -f jenkins-values.yaml jenkinsci/jenkins
```

Follow the printed instructions.

When this fails in the init container do:
https://github.com/jenkinsci/helm-charts/issues/195#issuecomment-1184309342
This is because of pv permissions specific to Docker Destkop.

**Install Notes**:
1. Get your 'admin' user password by running:
  `kubectl exec --namespace jenkins -it svc/jenkins -c jenkins -- /bin/cat /run/secrets/additional/chart-admin-password && echo`
2. Get the Jenkins URL to visit by running these commands in the same shell:
  `export NODE_PORT=$(kubectl get --namespace jenkins -o jsonpath="{.spec.ports[0].nodePort}" services jenkins)`
  `export NODE_IP=$(kubectl get nodes --namespace jenkins -o jsonpath="{.items[0].status.addresses[0].address}")`
  `echo http://$NODE_IP:$NODE_PORT`

3. Login with the password from step 1 and the username: admin
   This may need to be http://localhost:32000
4. Configure security realm and authorization strategy
5. Use Jenkins Configuration as Code by specifying configScripts in your values.yaml file, see documentation: http://$NODE_IP:$NODE_PORT/configuration-as-code and examples: https://github.com/jenkinsci/configuration-as-code-plugin/tree/master/demos
